---
/**
 * TopRegionsCard Component
 * Displays top 10 areas ranked by crime count
 * Data updates dynamically via JavaScript when filters change
 */

interface Crime {
  area: string;
  [key: string]: any;
}

interface Props {
  crimes: Crime[];
}

const { crimes } = Astro.props;

// Calculate top areas
const areaCounts = Array.from(
  crimes.reduce((acc, crime) => {
    const area = crime.area || 'Unknown';
    acc.set(area, (acc.get(area) || 0) + 1);
    return acc;
  }, new Map<string, number>())
)
  .sort((a, b) => b[1] - a[1])
  .slice(0, 10);
---

<div id="topRegionsCard" class="bg-white/50 backdrop-blur-md rounded-lg p-4 shadow-md">
  <h3 class="text-h3 font-bold text-slate-700 mb-4">Top Areas</h3>
  <div id="topRegionsContainer" class="space-y-2">
    {areaCounts.map(([area, count]) => (
      <div class="flex justify-between items-center pb-2 border-b border-slate-200 last:border-0">
        <span class="text-xs text-slate-500">{area}</span>
        <span class="px-3 py-1 min-h-[22px] flex items-center justify-center rounded-full bg-rose-600 text-white text-xs font-medium">
          {count}
        </span>
      </div>
    ))}
  </div>
</div>
