---
/**
 * FAQ Page
 * Frequently Asked Questions with Schema.org FAQPage markup
 */

import Layout from '../layouts/Layout.astro';
import Breadcrumbs from '../components/Breadcrumbs.astro';
import { routes } from '../config/routes';

const title = "FAQ — Crime Hotspots | Frequently Asked Questions";
const description = "Answers to frequently asked questions about Crime Hotspots. Learn about our data sources, update frequency, how to navigate the platform, and privacy policies.";

// FAQ data for Schema.org and rendering
const faqData = [
  {
    category: "Data Accuracy and Sources",
    questions: [
      {
        question: "Where does Crime Hotspots get its crime data?",
        answer: "Our crime data is sourced from public reports by established Trinidad & Tobago media outlets including the Trinidad Express and CNC3. We also monitor high-traffic community sources on Facebook, such as Ian Alleyne and DJ Sheriff, to capture incidents that may not appear in traditional media. This combination ensures broad coverage of reported crime across the country."
      },
      {
        question: "How often is the crime data updated?",
        answer: "Our data is updated daily as new incidents are reported by media outlets. Each crime is dated by when it happened, not when it was published — so a robbery that occurred on January 2nd but was reported on January 4th will appear under January 2nd. This means recent dates may initially show fewer entries until all reports for that period have been published. It is not a delay — it reflects our commitment to accurate, incident-based dating rather than publication-based dating."
      },
      {
        question: "What year of data am I viewing when I first visit the site?",
        answer: "By default, all dashboards and maps show data from the current year (e.g., 2026 data in 2026). This ensures you are seeing the most recent crime trends and statistics. You can switch to view previous years using the year filter available in the Filters menu on the Dashboard."
      },
      {
        question: "Is your data based on official police statistics?",
        answer: "No. We aggregate incidents as they are reported by the media, not official police records. This means our figures reflect media coverage and public awareness, not necessarily official verified crime counts. We recommend cross-referencing our data with government statistics for formal research."
      },
      {
        question: "Do you use AI to analyze the crime reports?",
        answer: "Yes, we use Claude AI to extract structured data (crime type, date, location, victim details) from unstructured news articles and social media posts. This AI-driven extraction ensures consistency and speed across hundreds of reports. All high-severity incidents are subject to human oversight before publication to ensure accuracy."
      }
    ]
  },
  {
    category: "How to Use the Platform",
    questions: [
      {
        question: "What sections are available on Crime Hotspots?",
        answer: "The platform includes several sections: the Dashboard (interactive map and statistics), Headlines (latest crime reports with filtering), Areas (crime data by neighbourhood), Compare (side-by-side area comparison), Archive (historical data by year and month), Statistics (year-to-date breakdowns by crime type), Regions (crime grouped by region), and Murder Count (live running total for the year). On mobile, use the bottom navigation bar to switch between key sections."
      },
      {
        question: "How can I find the crime rate for my specific area?",
        answer: "Visit the Areas page to browse all covered neighbourhoods, grouped by region. Each area shows a risk level score (1-10), recent incident count, and a safety assessment. You can search for your area by name or browse by region. Tap any area card to see detailed statistics, crime breakdowns, and recent headlines for that neighbourhood."
      },
      {
        question: "How do I compare two areas?",
        answer: "Use the Compare page to view side-by-side crime statistics for any two areas. Select your areas from the dropdown menus to see differences in crime counts, types, and trends. You can access Compare from the Areas page or from the navigation menu."
      },
      {
        question: "What do the risk level scores mean?",
        answer: "Each area is assigned a risk level score from 1 to 10, based on a 90-day rolling window of crime density relative to the rest of the country. A score below 4 is considered low risk, 4-7 is neutral, and above 7 is elevated. Each area page also includes a tailored safety insight with practical tips based on the most common crime type in that neighbourhood."
      },
      {
        question: "How do I view crime details without leaving the page?",
        answer: "When browsing Headlines, Areas, or the Archive, tapping on a crime headline opens a detail modal showing the full summary, location, safety context, and related crimes. You can browse between related crimes within the modal. Use the back button or tap outside to close it and return to where you were."
      },
      {
        question: "How do I view data from previous years?",
        answer: "Click the Filters button on the Dashboard or Headlines page and use the year selector to choose which year to view. You can also visit the Archive section to browse crime data organized by year and month. All historical data remains permanently accessible."
      },
      {
        question: "How do I read the crime map?",
        answer: "The map on the Dashboard uses incident markers placed at the reported crime location. Clusters of markers indicate a crime hotspot. Tap any marker to view details including the crime type, date, and a link to the full report."
      }
    ]
  },
  {
    category: "Coverage and Limitations",
    questions: [
      {
        question: "What countries do you currently cover?",
        answer: "Crime Hotspots currently covers Trinidad & Tobago with comprehensive daily updates. Coverage for additional Caribbean islands is planned for the future. If you would like to request coverage for a specific island, please get in touch via our Contact page."
      },
      {
        question: "What are the main limitations of your crime data?",
        answer: "Our key limitation is that we only reflect media-reported crimes. Unreported crimes or incidents that receive no press or social media coverage are not captured, particularly in remote rural areas. Our data represents media visibility, which may contain geographic biases toward metropolitan areas where reporting is more frequent."
      },
      {
        question: "Why are exact street addresses often not shown on the map?",
        answer: "While our source reports often contain exact addresses, we generalize the location to the nearest street junction or area name to maintain focus on community-wide trends rather than specific residences. This also helps balance data specificity with safety considerations."
      },
      {
        question: "Why do some locations have names different from the local name?",
        answer: "Our location data is validated against government and official mapping standards, so the names used correspond to recognized administrative or municipal boundaries. A locally known neighborhood name may be mapped under the broader official name of the area it falls within. This ensures accurate regional statistics across the platform."
      }
    ]
  },
  {
    category: "Privacy, Reporting, and Contact",
    questions: [
      {
        question: "Does Crime Hotspots protect privacy?",
        answer: "Yes, we adhere to strict ethical standards. Our platform focuses on crime statistics and trends. We do not solicit or publish private, unverified information. We only reflect details that have already been made public by the originating news source, maintaining data fidelity to the public record. For complete details on how we collect and protect your data, please read our Privacy Policy."
      },
      {
        question: "Do you offer a way to report crime or submit a tip?",
        answer: "Yes. We provide a secure report form on our platform where you can submit crime information anonymously. This information is used to support local community awareness and is managed with confidentiality."
      },
      {
        question: "How do I report an issue with a crime listing?",
        answer: "Every crime detail page and crime preview modal includes a Report Issue button. Use it to flag incorrect information such as wrong location, crime type, date, or other details. Your submission is reviewed and helps us maintain data accuracy across the platform."
      },
      {
        question: "How can I get in touch with Crime Hotspots?",
        answer: "Visit our Contact page to send us an email. Whether you have a question, a partnership idea, a data correction, or want to request coverage for your island, we would love to hear from you."
      }
    ]
  }
];

// Flatten questions for Schema.org
const allQuestions = faqData.flatMap(category => category.questions);
---

<Layout title={title} description={description}>
  <!-- FAQPage Schema.org markup -->
  <script type="application/ld+json" set:html={JSON.stringify({
    "@context": "https://schema.org",
    "@type": "FAQPage",
    "mainEntity": allQuestions.map(q => ({
      "@type": "Question",
      "name": q.question,
      "acceptedAnswer": {
        "@type": "Answer",
        "text": q.answer
      }
    }))
  })} />

  <main class="flex-1 w-full max-w-3xl mx-auto px-4 sm:px-6 py-4 sm:py-12">
    <Breadcrumbs items={[
      { label: 'Home', href: routes.home },
      { label: 'FAQ' }
    ]} />
    <h1 class="text-display text-slate-700 dark:text-[hsl(0_0%_95%)] font-semibold mb-3 text-center pt-4">Frequently Asked Questions</h1>
    <p class="text-xs text-slate-500 dark:text-[hsl(0_0%_65%)] mb-8 text-center">Common questions about Crime Hotspots, our data sources, and how to use the platform.</p>

    <div class="bg-white/70 dark:bg-[hsl(0_0%_8%_/_0.7)] backdrop-blur-md rounded-3xl shadow-md p-6 sm:p-8 border border-slate-100 dark:border-[hsl(0_0%_18%)]">
      {faqData.map((category) => (
        <div class="mb-8 last:mb-0">
          <h2 class="text-heading font-semibold mb-4 text-slate-600 dark:text-[hsl(0_0%_75%)]">{category.category}</h2>
          <div class="space-y-3">
            {category.questions.map((item, index) => (
              <div class="border border-slate-200 dark:border-[hsl(0_0%_20%)] rounded-lg overflow-hidden">
                <button
                  class="faq-question w-full text-left px-4 py-3 flex justify-between items-start gap-3 hover:bg-slate-50 dark:hover:bg-[hsl(0_0%_12%)] active:bg-slate-100 dark:active:bg-[hsl(0_0%_15%)] transition-colors"
                  aria-expanded="false"
                  data-faq-id={`${category.category}-${index}`}
                >
                  <span class="text-sm font-medium text-slate-500 dark:text-[hsl(0_0%_75%)] flex-1">{item.question}</span>
                  <span class="flex-shrink-0">
                    <svg class="faq-icon w-4 h-4 text-slate-400 dark:text-[hsl(0_0%_45%)] transform transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                    </svg>
                  </span>
                </button>
                <div class="faq-answer px-4 text-xs text-slate-500 dark:text-[hsl(0_0%_65%)]">
                  {item.answer}
                  {item.question.includes("report crime") && (
                    <span>
                      {' '}<a href={routes.report} class="text-rose-600 dark:text-rose-400 hover:text-rose-700 dark:hover:text-rose-300 font-medium underline">Submit a report here</a>.
                    </span>
                  )}
                  {item.question.includes("protect privacy") && (
                    <span>
                      {' '}<a href={routes.privacy} class="text-rose-600 dark:text-rose-400 hover:text-rose-700 dark:hover:text-rose-300 font-medium underline">Read our Privacy Policy</a>.
                    </span>
                  )}
                  {item.question.includes("get in touch") && (
                    <span>
                      {' '}<a href={routes.contact} class="text-rose-600 dark:text-rose-400 hover:text-rose-700 dark:hover:text-rose-300 font-medium underline">Go to Contact page</a>.
                    </span>
                  )}
                  {item.question.includes("countries do you currently") && (
                    <span>
                      {' '}<a href={routes.contact} class="text-rose-600 dark:text-rose-400 hover:text-rose-700 dark:hover:text-rose-300 font-medium underline">Contact us</a>.
                    </span>
                  )}
                </div>
              </div>
            ))}
          </div>
        </div>
      ))}
    </div>
  </main>

  <style>
    /* height: auto is animatable because Layout.astro sets html { interpolate-size: allow-keywords } */
    .faq-answer {
      height: 0;
      overflow: hidden;
      transition: height 300ms ease;
    }
    .faq-answer.open {
      height: auto;
      padding-bottom: 1rem;
    }
    .faq-icon {
      transition: transform 0.3s ease;
    }
  </style>

  <!-- FAQ Accordion Script -->
  <script>
    document.addEventListener('astro:page-load', () => {
      const questions = document.querySelectorAll('.faq-question');

      questions.forEach(question => {
        question.addEventListener('click', function() {
          const answer = this.nextElementSibling;
          const icon = this.querySelector('.faq-icon');
          const isExpanded = this.getAttribute('aria-expanded') === 'true';

          if (isExpanded) {
            answer.classList.remove('open');
            icon.style.transform = 'rotate(0deg)';
            this.setAttribute('aria-expanded', 'false');
          } else {
            answer.classList.add('open');
            icon.style.transform = 'rotate(45deg)';
            this.setAttribute('aria-expanded', 'true');
          }
        });
      });
    });
  </script>
</Layout>
