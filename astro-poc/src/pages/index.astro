---
/**
 * Homepage - Country Selection
 * Caribbean-wide crime statistics portal
 */

// Keep homepage static (pre-rendered at build time)
export const prerender = true;

import { Image } from 'astro:assets';
import Layout from '../layouts/Layout.astro';
import InfoPopup from '../components/InfoPopup.astro';
import HomepagePulse from '../components/HomepagePulse.astro';
import QuickAnswers from '../components/QuickAnswers.astro';
import { routes } from '../config/routes';
// Import optimized images (Astro converts to WebP automatically)
import trinidadImg from '../assets/images/trinidad.jpg';
import guyanaImg from '../assets/images/guyana.jpg';
import barbadosImg from '../assets/images/barbados.jpg';
// Dark mode variants (transparent background, blends with dark card)
import trinidadDarkImg from '../assets/images/trinidad-card-trsp-bg.png';
import guyanaDarkImg from '../assets/images/guyana-card-trsp-bg.png';
import barbadosDarkImg from '../assets/images/barbados-card-trsp-bg.png';

const title = "Crime Hotspots Caribbean â€” Live Crime Statistics for the Caribbean";
const description = "Live crime statistics and interactive maps for Trinidad & Tobago. Track murders, robberies, and incidents by location with verified data from Guardian, Express, and Newsday.";

// Country data (Trinidad-only focus for now)
const countries = [
  {
    id: 'tt',
    name: 'Trinidad & Tobago',
    short: 'Nationwide coverage',
    flag: 'ðŸ‡¹ðŸ‡¹',
    dashboard: routes.trinidad.dashboard,
    available: true,
    image: trinidadImg,
    darkImage: trinidadDarkImg,
  },
  {
    id: 'gy',
    name: 'Guyana',
    short: 'Coming soon',
    flag: 'ðŸ‡¬ðŸ‡¾',
    dashboard: '/guyana/dashboard',
    available: false,
    image: guyanaImg,
    darkImage: guyanaDarkImg,
  },
  {
    id: 'bdos',
    name: 'Barbados',
    short: 'Coming soon',
    flag: 'ðŸ‡§ðŸ‡§',
    dashboard: '/barbados/dashboard',
    available: false,
    image: barbadosImg,
    darkImage: barbadosDarkImg,
  }
];
---

<Layout title={title} description={description} includeLeaflet={false} includePagefind={false}>
  <main class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-5">
    <!-- Hero Section -->
    <section class="flex flex-col items-center justify-center text-center mb-12">
      <div class="text-center max-w-2xl mx-auto mb-8">
        <h1 class="text-display font-bold text-slate-900 dark:text-[hsl(0_0%_95%)] mb-3">
          Know Where. Stay Safe.
        </h1>
        <p class="text-body font-normal text-slate-500 dark:text-[hsl(0_0%_60%)]">
          Live crime data and safety trends for your area.
        </p>
      </div>

      <!-- Country Cards: Trinidad (with pulse) + Coming Soon -->
      <div class="flex flex-col items-center gap-8 sm:gap-10" role="list" aria-label="Countries">

        <!-- Trinidad: Unified card (image + live stats) -->
        <div role="listitem">
          <a
            href={routes.trinidad.dashboard}
            class="group relative block w-full max-w-[280px] sm:max-w-xs rounded-2xl shadow-sm overflow-hidden dark:ring-1 dark:ring-white/15 bg-white/70 dark:bg-[hsl(0_0%_5%)] hover:shadow-lg transition-shadow duration-300 cursor-pointer"
          >
            <!-- Card header: country name + LIVE badge -->
            <div class="flex items-center justify-between px-3 pt-2.5 pb-2">
              <h2 class="text-caption font-bold text-slate-700 dark:text-[hsl(0_0%_85%)]">ðŸ‡¹ðŸ‡¹ Trinidad & Tobago</h2>
              <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-rose-600/90 backdrop-blur-sm text-white text-[10px] font-bold tracking-wide uppercase">
                <span class="relative flex h-1.5 w-1.5">
                  <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-white opacity-75"></span>
                  <span class="relative inline-flex rounded-full h-1.5 w-1.5 bg-white"></span>
                </span>
                Live
              </span>
            </div>

            <!-- Island image: hover lifts + scales slightly -->
            <div class="w-full aspect-square overflow-hidden bg-white/70 dark:bg-transparent">
              <Image
                src={trinidadImg}
                alt="Trinidad & Tobago map"
                class="w-full h-full object-cover block dark:hidden transition-transform duration-300 ease-out group-hover:scale-[1.04] group-hover:-translate-y-1"
                loading="eager"
                width={280}
                height={280}
                format="webp"
                quality={80}
              />
              <Image
                src={trinidadDarkImg}
                alt="Trinidad & Tobago map"
                class="w-full h-full object-cover hidden dark:block transition-transform duration-300 ease-out group-hover:scale-[1.04] group-hover:-translate-y-1"
                loading="eager"
                width={280}
                height={280}
                format="webp"
                quality={80}
              />
            </div>

            <!-- Live stats embedded inline -->
            <HomepagePulse embedded countryName="Trinidad & Tobago" dashboardUrl={routes.trinidad.dashboard} />
          </a>
        </div>

        <!-- Coming Soon Countries -->
        <div class="flex gap-6 sm:gap-8">
          {countries.filter(c => !c.available).map(country => (
            <div
              class="w-full max-w-[200px] sm:max-w-[220px] rounded-2xl shadow-sm overflow-hidden dark:ring-1 dark:ring-white/15 bg-white/70 dark:bg-[hsl(0_0%_5%)] opacity-60 cursor-not-allowed"
              role="listitem"
            >
              <div class="block" aria-disabled="true" role="button" tabindex="-1">
                <div class="w-full aspect-square overflow-hidden bg-slate-200 dark:bg-[hsl(0_0%_10%)] relative">
                  <Image
                    src={country.image}
                    alt={`${country.name} map`}
                    class="w-full h-full object-cover grayscale block dark:hidden"
                    loading="lazy"
                    width={220}
                    height={220}
                    format="webp"
                    quality={60}
                  />
                  <Image
                    src={country.darkImage}
                    alt={`${country.name} map`}
                    class="w-full h-full object-cover grayscale hidden dark:block"
                    loading="lazy"
                    width={220}
                    height={220}
                    format="webp"
                    quality={60}
                  />
                  <div class="absolute inset-0 bg-slate-300/20 dark:bg-slate-900/30"></div>
                </div>
                <div class="pb-8 px-3 text-center">
                  <h2 class="text-caption font-bold text-slate-500 dark:text-[hsl(0_0%_70%)] mb-1">{country.name}</h2>
                  <div class="mt-3">
                    <span class="inline-block px-6 py-1 rounded-full bg-slate-200 dark:bg-[hsl(0_0%_12%)] text-xs text-slate-500 dark:text-[hsl(0_0%_50%)] font-medium">
                      Coming Soon
                    </span>
                  </div>
                </div>
              </div>
            </div>
          ))}
        </div>
      </div>

      <QuickAnswers />

      <div class="mt-16 flex items-center gap-2">
        
        <InfoPopup id="homepage-info">
          <p class="font-bold mb-2 text-slate-700 dark:text-[hsl(0_0%_90%)]">Verified Crime Intelligence</p>
          <p class="mb-5 text-slate-500 dark:text-[hsl(0_0%_60%)]">Our platform aggregates data from Trinidad & Tobago's trusted news outlets, with plans to expand across the Caribbean.</p>

          <!-- Feature 1 -->
          <div class="flex items-start gap-3 mb-4">
            <svg class="w-5 h-5 text-slate-400 dark:text-[hsl(0_0%_50%)] shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7" />
            </svg>
            <div>
              <p class="text-caption font-bold text-slate-600 dark:text-[hsl(0_0%_80%)] mb-0.5">Interactive Maps</p>
              <p class="text-slate-500 dark:text-[hsl(0_0%_60%)]">Visualize crime hotspots with geographic precision and regional breakdowns.</p>
            </div>
          </div>

          <!-- Feature 2 -->
          <div class="flex items-start gap-3 mb-4">
            <svg class="w-5 h-5 text-slate-400 dark:text-[hsl(0_0%_50%)] shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
            </svg>
            <div>
              <p class="text-caption font-bold text-slate-600 dark:text-[hsl(0_0%_80%)] mb-0.5">Live Statistics</p>
              <p class="text-slate-500 dark:text-[hsl(0_0%_60%)]">Track crime trends over time with detailed analytics and reporting.</p>
            </div>
          </div>

          <!-- Feature 3 -->
          <div class="flex items-start gap-3 mb-6">
            <svg class="w-5 h-5 text-slate-400 dark:text-[hsl(0_0%_50%)] shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
            </svg>
            <div>
              <p class="text-caption font-bold text-slate-600 dark:text-[hsl(0_0%_80%)] mb-0.5">Trusted Sources</p>
              <p class="text-slate-500 dark:text-[hsl(0_0%_60%)]">Data sourced from verified Caribbean news outlets and official reports.</p>
            </div>
          </div>

          <div class="flex justify-center">
            <a
              href={routes.about}
              aria-label="Learn more about Crime Hotspots data sources and methodology"
              class="inline-flex items-center gap-1.5 px-3 py-1 rounded-full border border-slate-300 dark:border-[hsl(0_0%_30%)] text-slate-500 dark:text-[hsl(0_0%_55%)] text-xs hover:border-slate-400 dark:hover:border-[hsl(0_0%_40%)] hover:text-slate-700 dark:hover:text-[hsl(0_0%_70%)] transition"
            >
              Read the full methodology
            </a>
          </div>
        </InfoPopup>
      </div>
    </section>
  </main>
</Layout>

<script
  type="application/ld+json"
  set:html={`
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "Crime Hotspots",
      "url": "https://crimehotspots.com",
      "description": "Real-time crime statistics and interactive dashboards for the Caribbean",
      "publisher": {
        "@type": "Organization",
        "name": "Crime Hotspots",
        "url": "https://crimehotspots.com"
      }
    }
  `}
/>
